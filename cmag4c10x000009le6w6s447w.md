---
title: "TryHackMe Room overpass"
seoTitle: "Overpass: TryHackMe Hacking Challenge"
seoDescription: "Explore TryHackMe's Overpass room to learn vulnerability exploitation and flag discovery. Ideal for cybersecurity enthusiasts!"
datePublished: Fri May 09 2025 01:29:31 GMT+0000 (Coordinated Universal Time)
cuid: cmag4c10x000009le6w6s447w
slug: tryhackme-room-overpass
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1746744533776/054e9d9f-f7a6-4ebc-aa7a-49feebb1f5dc.png
tags: tryhackme, thm, thm-writeup, tryhackme-walkthrough

---

Lien de la room: [TryHackMe | Overpass](https://tryhackme.com/room/overpass)

# Flag user.txt

On d√©bute par un scan nmap. On a juste deux ports ouverts.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746744768060/6b544e65-acb6-443c-8b33-fee9e288c9b0.png align="center")

L‚Äôinterface web sur le port 80 nous renvoie une page assez basique

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746744860080/7a949893-4c53-4258-b676-6d04013e89c1.png align="center")

La commande `gobuster dir -u 10.10.140.46 -w /usr/share/wordlists/dirb/big.txt` nous donne un r√©pertoire plut√¥t int√©ressant.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746746045174/f54b7093-ef23-4e4c-957d-201e365be54e.png align="center")

Il s‚Äôagit d‚Äôune page de connexion.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746746015553/bce0f15e-f825-449e-8f37-175d01f50616.png align="center")

On tente de l‚Äôinjection SQL ici. Apr√®s avoir envoy√© des donn√©es al√©atoires, je vois qu‚Äôune requ√™te POST est envoy√©e √† `http://10.10.140.46/api/login`.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746748248311/16c90eaf-6b65-4178-ac8a-b6600445c6fd.png align="center")

On va donc utiliser ffuf vers cette adresse avec une liste de payloads disponible sur [Github](https://github.com/Mehdi0x90/Web_Hacking/blob/main/Login%20Bypass.md).

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746749091326/be2f0e59-8a29-46ad-b488-803ccba6ffc2.png align="center")

Mais on a rien comme r√©sultat.

En fouillant un peu plus au niveau de l‚Äôinspecteur, on tombe sur un fichier `login.js`.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746749139279/c3e49d3a-c516-4d91-8771-9b55152a1488.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746749199562/f1ba126b-8ae4-4b2f-b0bb-d0390a83cef0.png align="center")

En regardant de plus pr√®s, le bout de code ci-dessous, on voit qu‚Äôil contient une faille plut√¥t logique.

```javascript
if (statusOrCookie === "Incorrect credentials") {
  // √©chec
} else {
  // tout le reste = succ√®s ‚Üí on stocke ce qu‚Äôon a re√ßu comme token
  Cookies.set("SessionToken", statusOrCookie)
  window.location = "/admin"
}
```

Seul le texte `"Incorrect credentials"` est trait√© comme un √©chec. Tout autre r√©ponses valident la connexion et redirigent vers `/admin`. On peut donc en tirer parti et modifier manuellement depuis la console du navigateur.

En premier lieu au niveau de la console du navigateur, j‚Äôinjecte un cookie quelconque puis j‚Äôappuie sur Entr√©e mais rien ne se passe.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746750978478/b53f584d-c2c8-4f1b-99c0-836314ee92fc.png align="center")

Ensuite au Niveau du Sotckage, j‚Äôajoute un nouveau cookie puis je recharge la page.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746750941023/ca84ca75-711b-417d-b58f-edc239a25ddb.png align="center")

On a donc acc√®s √† la page admin et on y voir une cl√© priv√©e, avec un nom d‚Äôutilisateur James. On peut donc potentiellement avoir une connection en ssh.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746751041707/3aad40e9-6ed2-4687-9dee-19d0913eb57f.png align="center")

La cl√© est chiffr√©e en `AES-128-CBC`. Il va donc falloir en extraire une empreinte exploitable par John the Ripper, cracker la passphrase, puis d√©chiffrer la cl√©.

On copie d‚Äôabord l‚Äôenti√®ret√© de la cl√© d√©butant par `-----BEGIN RSA PRIVATE KEY-----`. Avec `ssh2john`, on g√©n√®re le hash.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746752509590/c5503f53-e435-4cbc-813e-718bbf532d08.png align="center")

On le cracke ensuite avec `john`.

ü´§Petit blocage ici. L‚Äôoutil john n‚Äôest pas install√© sur la machine.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746753164125/de98c60b-f247-4a1c-82e5-dc08834894ef.png align="center")

ChatGPT m‚Äôa donc fourni une alternative üòô. Un script permettant de trouver la passphrase de la cl√© priv√©e.

```bash
#!/bin/bash
KEYFILE="priv_key"
WORDLIST="/usr/share/wordlists/rockyou.txt"

while IFS= read -r pass; do
  # Tente de d√©chiffrer ; on envoie stdout/stderr vers /dev/null
  openssl rsa -in "$KEYFILE" -passin pass:"$pass" -out /dev/null 2>/dev/null
  if [ $? -eq 0 ]; then
    echo "[+] Passphrase trouv√©e : $pass"
    exit 0
  fi
done < "$WORDLIST"

echo "[-] Aucune passphrase trouv√©e dans $WORDLIST"
```

√Ä copier dans un fichier `crack.sh` puis le rendre ex√©cutable avec `chmod +x crack.sh`. Lancer ensuite le script avec `./crack.sh`.

On a maintenant la passphrase üòã. On peut se connecter avec l'utilisateur trouv√© un peu plus haut.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746753459960/2325aa1a-4ac5-42ea-a432-9e0aca9dc944.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746753964234/171618d8-203e-4aca-b465-7f06c840713f.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746754027298/8abe0810-68a3-4a22-b52e-38422d43247a.png align="center")

On arrive √† se connecter et on le premier flag ü•≥.

# Flag root.txt